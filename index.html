<!DOCTYPE html>
<html lang="ja" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>勤怠管理 送信</title>
    <script type="text/javascript" src="./lib/jQuery.js"></script>
    <link rel="stylesheet" media="screen" href="./lib/font.css">
    <script type="text/javascript" charset="utf-8" src="./lib/setup_icon.js"></script>
    <link rel="stylesheet" media="screen" href="./lib/layout.menu.css">
    <script type="text/javascript" charset="utf-8" src="./lib/toolbox.menu.js"></script>
    <link rel="stylesheet" media="screen" href="./lib/layout.timetable.css">
    <script type="text/javascript" charset="utf-8" src="./lib/getTimer.js"></script>
    <script type="text/javascript" charset="utf-8" src="./lib/isJSON.js"></script>

    <meta name="viewport" content="width=device-width,initial-scale=1">
    <link rel="manifest" href="./lib/manifest.json">
    <script type="text/javascript">
      // Service Worker 登録
      localStorage.setItem( (btoa(location.href)).slice(0, 16) + '.ServiceWorker', JSON.stringify({token: ''}) );
      if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('./lib/ServiceWorker.js').then(function(registration) {
          localStorage.setItem( (btoa(location.href)).slice(0, 16) + '.ServiceWorker', JSON.stringify({token: registration.scope}) );
        }).catch(function(err) {
          console.error('ServiceWorker registration failed. ');
          console.error(err);
        });
      } else {
        if (location.protocol != 'https:') {
          console.error('ServiceWorker registration failed. Not supported on http.');
        } else {
          console.error('ServiceWorker registration failed. Not supported on this browser.');
        }
      }
    </script>

    <script type="text/javascript" src="https://www.google.com/recaptcha/api.js?render=6LfCHdcUAAAAAOwkHsW_7W7MfoOrvoIw9CXdLRBA"></script>
    <script type="text/javascript">
      /*
       * Admin console url is 'https://www.google.com/recaptcha/admin'
       * Site key is '6LfCHdcUAAAAAOwkHsW_7W7MfoOrvoIw9CXdLRBA' (Use in 2 place)
       */
      grecaptcha.ready(function() {
        grecaptcha.execute('6LfCHdcUAAAAAOwkHsW_7W7MfoOrvoIw9CXdLRBA', {action: 'homepage'}).then(function(token) {
          localStorage.setItem( (btoa(location.href)).slice(0, 16) + '.reCAPTCHA', JSON.stringify({token: token}) );
        });
      });
    </script>

    <script type="text/javascript">
      function targetMonth_shift(offset){
        var targetMonth = JSON.parse(localStorage.getItem( (btoa(location.href)).slice(0, 16) + '.targetMonth' ));
        console.log( targetMonth );

        var targetMonthCurrent = new Date( Number(targetMonth['year']), Number(targetMonth['month']) - offset, 1);
        targetMonthCurrent.setMonth( targetMonthCurrent.getMonth() - offset);

        targetMonth.year  = ( '0000' + ( targetMonthCurrent.getFullYear() ) ).slice(-4);
        targetMonth.month = ( '00'   + ( targetMonthCurrent.getMonth() + 1 ) ).slice(-2);

        localStorage.setItem( (btoa(location.href)).slice(0, 16) + '.targetMonth', JSON.stringify(targetMonth) );
        location.replace( location.href );
      }
      function targetMonth_this(){
        var targetMonth = JSON.parse(localStorage.getItem( (btoa(location.href)).slice(0, 16) + '.targetMonth' ));
        targetMonth = {
          year: getTimer()['year'],
          month: getTimer()['month'],
        }
        localStorage.setItem( (btoa(location.href)).slice(0, 16) + '.targetMonth', JSON.stringify(targetMonth) );
        location.replace( location.href );
      }
    </script>
    <script type="text/javascript">
      $(function(){
        $('a.month_next').click(function(){ targetMonth_shift(0); });
        $('a.month_prev').click(function(){ targetMonth_shift(1); });
        $('a.month_this').click(function(){ targetMonth_this();   });
      });
    </script>
    <script type="text/javascript">
      $(function(){
        var targetMonth = JSON.parse(localStorage.getItem( (btoa(location.href)).slice(0, 16) + '.targetMonth' ));
        if (!targetMonth) {
          targetMonth = {
            year: getTimer()['year'],
            month: getTimer()['month'],
          }
          localStorage.setItem( (btoa(location.href)).slice(0, 16) + '.targetMonth', JSON.stringify(targetMonth) );
        }

        $('#timetable h1').text( Number(targetMonth['month']) + '月' + ' ' + Number(targetMonth['year']) );

        // 本体生成
        $('#kintai_timetable').append('<tbody />');

        // 日付ごとに子供生成
        for (var tbody_date = 1; tbody_date <= new Date(Number(targetMonth['year']), Number(targetMonth['month']), 0).getDate(); tbody_date++) {
          tbody_date_str = ('0' + tbody_date).slice(-2);

          // ja-JP 表記で曜日を取得
          tbody_date_str_day = ['日', '月', '火', '水', '木', '金', '土'][
            new Date(
              Number(targetMonth['year']),
              Number(targetMonth['month']) - 1,
              Number(tbody_date_str)
            ).getDay()
          ];
          var prev_day = new Date(
            Number(targetMonth['year']),
            Number(targetMonth['month']) - 1,
            Number(tbody_date_str) - 1
          );

          // 孫生成
          $('#kintai_timetable').children('tbody').append('<tr />');

          // その日の日付オブジェクト
          var targetDate = new Date(
            Number(targetMonth['year']),
            Number(targetMonth['month']) - 1,
            Number(tbody_date_str)
          );

          if(false){}
          else if( targetDate.toDateString() == (new Date()).toDateString() ){ /* 今日 */
            $('#kintai_timetable tbody tr:last-child').addClass('day_today');
          }
          else if( targetDate.getDay() == 0 ){ /* 日曜日 */
            $('#kintai_timetable tbody tr:last-child').addClass('day_sunday');
          }
          else if( targetDate.getDay() == 6 ){ /* 土曜日 */
            $('#kintai_timetable tbody tr:last-child').addClass('day_saturday');
          }

          // ひ孫生成
          $('#kintai_timetable tbody tr:last-child').append('<td />');
          $('#kintai_timetable tbody tr:last-child td:last-child').text(Number(targetMonth['month']) + '/' + tbody_date_str + '('+tbody_date_str_day+')');
          $('#kintai_timetable tbody tr:last-child td:last-child').append('<input />');
          $('#kintai_timetable tbody tr:last-child td:last-child input').attr({type: 'hidden'});
          $('#kintai_timetable tbody tr:last-child td:last-child input').val( targetMonth['year'] + targetMonth['month'] + tbody_date_str );

          // 始業時間
          $('#kintai_timetable tbody tr:last-child').append('<td />');
          $('#kintai_timetable tbody tr:last-child td:last-child').html('<input />:<input /><input />');
          $('#kintai_timetable tbody tr:last-child td:last-child input').eq(0).attr({
            type: 'tel', maxlength: 2,
            name: 'shigyo_h_' + tbody_date_str,
          }).addClass('timer_io timer_hour');
          $('#kintai_timetable tbody tr:last-child td:last-child input').eq(1).attr({
            type: 'tel', maxlength: 2,
            name: 'shigyo_m_' + tbody_date_str,
          }).addClass('timer_io timer_min');
          $('#kintai_timetable tbody tr:last-child td:last-child input').eq(2).attr({
            type: 'hidden',
            name: 'shigyo_' + tbody_date_str,
          });

          // 終業時間
          $('#kintai_timetable tbody tr:last-child').append('<td />');
          $('#kintai_timetable tbody tr:last-child td:last-child').html('<input />:<input /><input />');
          $('#kintai_timetable tbody tr:last-child td:last-child input').eq(0).attr({
            type: 'tel', maxlength: 2,
            name: 'syugyo_h_' + tbody_date_str,
          }).addClass('timer_io timer_hour');
          $('#kintai_timetable tbody tr:last-child td:last-child input').eq(1).attr({
            type: 'tel', maxlength: 2,
            name: 'syugyo_m_' + tbody_date_str,
          }).addClass('timer_io timer_min');
          $('#kintai_timetable tbody tr:last-child td:last-child input').eq(2).attr({
            type: 'hidden',
            name: 'syugyo_' + tbody_date_str,
          });

          // 休憩時間1
          $('#kintai_timetable tbody tr:last-child').append('<td />');
          $('#kintai_timetable tbody tr:last-child td:last-child').html('<input />:<input /><input />');
          $('#kintai_timetable tbody tr:last-child td:last-child input').eq(0).attr({
            type: 'tel', maxlength: 2,
            name: 'kyukei_1_h_' + tbody_date_str,
          }).addClass('timer_io timer_hour timer_refresh');
          $('#kintai_timetable tbody tr:last-child td:last-child input').eq(1).attr({
            type: 'tel', maxlength: 2,
            name: 'kyukei_1_m_' + tbody_date_str,
          }).addClass('timer_io timer_min timer_refresh');
          $('#kintai_timetable tbody tr:last-child td:last-child input').eq(2).attr({
            type: 'hidden',
            name: 'kyukei_1_' + tbody_date_str,
          });

          // 休憩時間2
          $('#kintai_timetable tbody tr:last-child').append('<td />');
          $('#kintai_timetable tbody tr:last-child td:last-child').html('<input />:<input /><input />');
          $('#kintai_timetable tbody tr:last-child td:last-child input').eq(0).attr({
            type: 'tel', maxlength: 2,
            name: 'kyukei_2_h_' + tbody_date_str,
          }).addClass('timer_io timer_hour timer_refresh');
          $('#kintai_timetable tbody tr:last-child td:last-child input').eq(1).attr({
            type: 'tel', maxlength: 2,
            name: 'kyukei_2_m_' + tbody_date_str,
          }).addClass('timer_io timer_min timer_refresh');
          $('#kintai_timetable tbody tr:last-child td:last-child input').eq(2).attr({
            type: 'hidden',
            name: 'kyukei_2_' + tbody_date_str,
          });

          // シフト時間
          $('#kintai_timetable tbody tr:last-child').append('<td />');
          $('#kintai_timetable tbody tr:last-child td:last-child').html('<input /><img /><img />');
          $('#kintai_timetable tbody tr:last-child td:last-child input').eq(0).attr({
            type: 'hidden',
            name: 'workshift_' + tbody_date_str,
          });
          $('#kintai_timetable tbody tr:last-child td:last-child img').eq(0).attr({
            alt: '入力', src: './lib/icon/icon_edit.png',
            name: 'shifttime_input_' + tbody_date_str,
          }).addClass('dataicon shifttime_input');
          $('#kintai_timetable tbody tr:last-child td:last-child img').eq(1).attr({
            alt: '複製', src: './lib/icon/icon_copy.png',
            name: 'shifttime_copy_' + tbody_date_str,
          }).addClass('dataicon shifttime_copy');

          // 備考
          $('#kintai_timetable tbody tr:last-child').append('<td />');
          $('#kintai_timetable tbody tr:last-child td:last-child').html('<input />');
          $('#kintai_timetable tbody tr:last-child td:last-child input').eq(0).attr({
            type: 'text', maxlength: 64,
            name: 'bikou_' + tbody_date_str,
          });

          // 入力データ消去
          $('#kintai_timetable tbody tr:last-child td:last-child').append('<img />');
          $('#kintai_timetable tbody tr:last-child td:last-child img').eq(0).attr({
            alt: '', src: './lib/icon/icon_cross.png',
            name: 'datareset_' + tbody_date_str,
          }).addClass('dataicon datareset');
        }// 孫生成for{}

      });
    </script>
    <script type="text/javascript">
      $(function(){
        var targetMonth = JSON.parse(localStorage.getItem( (btoa(location.href)).slice(0, 16) + '.targetMonth' ));
        if (!targetMonth) {
          targetMonth = {
            year: getTimer()['year'],
            month: getTimer()['month'],
          }
          localStorage.setItem( (btoa(location.href)).slice(0, 16) + '.targetMonth', JSON.stringify(targetMonth) );
        }

        // 祝日チェック
        $('#kintai_timetable tbody tr td:first-child input').map(function(index_dom, dom){
          // 祝日一覧取得する
          $.ajax({
            type: 'GET',
            url: 'https://holidays-jp.github.io/api/v1/date.json',
            async: true,
            cache: true,
            contentType: false,
            dataType: 'text',
          }).done(function(responce){
            $.map(JSON.parse(responce.replace(/-/g, '')), function(arr, index_arr){
              // 取得したので、日付書式を合わせる
              if( index_arr.slice(0,4) == targetMonth['year'] && index_arr.slice(4,6) == targetMonth['month'] ) {
                // 対象付きのみ処理
                if( targetMonth['year'] + targetMonth['month'] + ('00'+(index_dom+1)).slice(-2) == index_arr ){
                  $('#kintai_timetable tbody tr:nth-child('+(index_dom+1)+')').addClass('day_holiday');
                  $('#kintai_timetable tbody tr:nth-child('+(index_dom+1)+') td:last-child input:first-child').attr({
                    title: arr,
                    placeholder: arr,
                  });
                }
              }
            });
          });
        });
      });
    </script>
    <script type="text/javascript">
      $(function(){
        $('a[href="#page_reload"]').click(function(){
          var href = location.href;
          href = href.replace(/\#.*/g, '');
          href = href.replace(/\?.*/g, '');
          location.replace( href );
        });
        $('a[href="#data_save"]').click(function(){
          $('#menu_bar').slideUp();

          var targetMonth = JSON.parse(localStorage.getItem( (btoa(location.href)).slice(0, 16) + '.targetMonth' ));
          if (!targetMonth) {
            targetMonth = {
              year: getTimer()['year'],
              month: getTimer()['month'],
            }
            localStorage.setItem( (btoa(location.href)).slice(0, 16) + '.targetMonth', JSON.stringify(targetMonth) );
          }
          // save the data is below
          // - timetable data
          // - google oauth credential
          var saveData = [];
          var sectionId = '01';

          saveData.push(
            [
              ( $('input[name=workshift_shigyo]').val() ),
              ( $('input[name=workshift_syugyo]').val() ),
              ( $('input[name=workshift_kyukei_1]').val() ),
              ( $('input[name=workshift_kyukei_2]').val() ),
            ],
          );

          for (
            var tbody_date = 1;
            tbody_date <= new Date(Number(targetMonth['year']), Number(targetMonth['month']), 0).getDate();
            tbody_date++
          ) {
            sectionId = ('00'+tbody_date).slice(-2);
            saveData.push(
                [
                  targetMonth['year'] + '/' + targetMonth['month'] + '/' + sectionId,
                  [
                    Number( $('input[name=shigyo_'   + sectionId + ']').val() ),
                    Number( $('input[name=syugyo_'   + sectionId + ']').val() ),
                    Number( $('input[name=kyukei_1_' + sectionId + ']').val() ),
                    Number( $('input[name=kyukei_2_' + sectionId + ']').val() ),
                  ],
                  $('input[name=bikou_' + sectionId + ']').val(),
                ]
            );
          }

          google_oauth_token = '';
          saveData = {
            'timetable_data': saveData,
            'google_oauth_token': google_oauth_token,
          };
          console.log(saveData);
          localStorage.setItem( (btoa(location.href)).slice(0, 16) + '.saveData', JSON.stringify(saveData) );

          $('#popUpMesg').fadeIn('slow');
          $('#popUpMesg_content').text('Saved!!');
          alert('Saved!!');
        });
        $('a[href="#conf_reset"]').click(function(){
          localStorage.clear();
          $('a[href="#page_reload"]').click();
        });
        $('a[href="#conf_setup"]').click(function(){
          $('#menu_bar').slideUp();

          // メニューアイコンサイズ調整
          $('input[name="Menu_icon_size"]').val(
            localStorage.getItem( (btoa(location.href)).slice(0, 16) + '.ini_Menu_icon_size' )
          );
          $('input[name="Menu_icon_size"]').next().text(
            parseInt(
              localStorage.getItem( (btoa(location.href)).slice(0, 16) + '.ini_Menu_icon_size' )
            )
          );

          // Google recaptcha 可視性調整
          $('input[name="Google_recaptcha_visibility"]').val(
            localStorage.getItem( (btoa(location.href)).slice(0, 16) + '.ini_Google_recaptcha_visibility' )
          );
          $('input[name="Google_recaptcha_visibility"]').next().text(
            parseFloat(
              localStorage.getItem( (btoa(location.href)).slice(0, 16) + '.ini_Google_recaptcha_visibility' )
            ).toFixed(1)
          );

          $('#menu_config_bar').fadeIn('slow');
        });
        $('#menu_config_bar_close').click(function(){
          $('#menu_config_bar').fadeOut('slow');
        });
        $('#popUpMesg_close').click(function(){
          $('#popUpMesg').fadeOut('slow');
        });

        $('a[href="#data_submit"]').click(function(){
          // oauth token check
          //
        });
      });
    </script>
    <script type="text/javascript">
      $(function(){
        $('input.timer_io').focus(function(){
          $(this).select();
        });
        $('input.timer_io').blur(function(){
          $(this).change();
        });
        $('input.timer_io').change(function(){
          $(this).val( ($(this).val()).replace(/[０-９]/g, function(s) {
            return String.fromCharCode(s.charCodeAt(0) - 0xFEE0);
          }) );
          $(this).val( ($(this).val()).replace(/[^0-9]/g, '') );/* 数字以外を削除 */

          var sectionId = $(this).attr('name').slice(-2);
          $('input[name=shigyo_'+sectionId+']').val(
              Number( $('input[name=shigyo_h_' + sectionId + ']').val()   * 60 )
            + Number( $('input[name=shigyo_m_' + sectionId + ']').val()        )
          );
          if ($('input[name=shigyo_h_' + sectionId + ']').val() == '') {
            $('input[name=shigyo_m_' + sectionId + ']').val('');
          }

          $('input[name=syugyo_'+sectionId+']').val(
              Number( $('input[name=syugyo_h_' + sectionId + ']').val()   * 60 )
            + Number( $('input[name=syugyo_m_' + sectionId + ']').val()        )
          );
          if ($('input[name=syugyo_h_' + sectionId + ']').val() == '') {
            $('input[name=syugyo_m_' + sectionId + ']').val('');
          }

          $('input[name=kyukei_1_'+sectionId+']').val(
              Number( $('input[name=kyukei_1_h_' + sectionId + ']').val() * 60 )
            + Number( $('input[name=kyukei_1_m_' + sectionId + ']').val()      )
          );
          if ($('input[name=kyukei_1_h_' + sectionId + ']').val() == '') {
            $('input[name=kyukei_1_m_' + sectionId + ']').val('');
          }

          $('input[name=kyukei_2_'+sectionId+']').val(
              Number( $('input[name=kyukei_2_h_' + sectionId + ']').val() * 60 )
            + Number( $('input[name=kyukei_2_m_' + sectionId + ']').val()      )
          );
          if ($('input[name=kyukei_2_h_' + sectionId + ']').val() == '') {
            $('input[name=kyukei_2_m_' + sectionId + ']').val('');
          }

          // 数値チェック
          var shigyo_time = $('input[name=shigyo_'   + sectionId + ']').val();
          var syugyo_time = $('input[name=syugyo_'   + sectionId + ']').val();
          var kyukei_1    = $('input[name=kyukei_1_' + sectionId + ']').val();
          var kyukei_2    = $('input[name=kyukei_2_' + sectionId + ']').val();
          $('#kintai_timetable tbody tr:nth-child('+sectionId+') input.timer_io').removeClass('err_validation');

          // 終業時間が 始業時間と同じもしくはそれ以下 の場合 -> エラー表示
          if ( Number(syugyo_time) <= Number(shigyo_time) ){
            $('#kintai_timetable tbody tr:nth-child('+sectionId+') input.timer_io').addClass('err_validation');
          }

          // 終業時間と始業時間が　文字なし の場合 -> エラー表示解除
          if ( ( syugyo_time == '' ) && ( shigyo_time == '' ) ) {
            $('#kintai_timetable tbody tr:nth-child('+sectionId+') input.timer_io').removeClass('err_validation');
            $('input[name=kyukei_1_h_' + sectionId + ']').val('');
            $('input[name=kyukei_1_m_' + sectionId + ']').val('');
            $('input[name=kyukei_2_h_' + sectionId + ']').val('');
            $('input[name=kyukei_2_m_' + sectionId + ']').val('');
          }

          console.log(sectionId
            + '   ' + ''
            + '   ' + shigyo_time
            + '   ' + syugyo_time
            + '   ' + kyukei_1
            + '   ' + kyukei_2
            + '   ' + '|'
            + '   ' + $('input[name=shigyo_'   + sectionId + ']').val()
            + '   ' + $('input[name=syugyo_'   + sectionId + ']').val()
            + '   ' + $('input[name=kyukei_1_' + sectionId + ']').val()
            + '   ' + $('input[name=kyukei_2_' + sectionId + ']').val()
          );
        });

        $('input.timer_hour').change(function(){
          if ($(this).val() >= 48) { $(this).val(0); }/* Out of range */
        });
        $('input.timer_min').change(function(){
          /*
           * quote: https://qiita.com/shuuuuun/items/f0031d710ca50b21177a
           * 配列から最も近い値(近似値)を探す
           */

          var value = $(this).val();
          if (value != '') {
            const minslist = [0, 15, 30, 45];
            var diff = [];
            var index = 0;

            $(minslist).each(function(i,val){
              diff[i] = Math.abs(value - val);
              index = (diff[index] < diff[i]) ? index : i;
            });

            $(this).val( minslist[index] );
          }
        });
        $('input.timer_hour:not(.timer_refresh)').focus(function(){
          /* blank のときは今の時間を代入 */
          if ($(this).val()=='') { $(this).val(getTimer()['hour']); }
          $(this).change();
        });
        $('input').change(function(){
          $('input:not(input[type=button])').map(function(index, element){
            //console.log({name: element.name, value: element.value});
          });
        });

        $('img.datareset').click(function(){
          const sectionId = ('00'+$(this).attr('name')).slice(-2);
          console.log($('#kintai_timetable tbody tr:nth-child('+sectionId+') input:not([type=button])'));;
          $('#kintai_timetable tbody tr:nth-child('+sectionId+') input:not([type=button])').val('');
          $('#kintai_timetable tbody tr:nth-child('+sectionId+') input:not([type=button])').map(function(index_dom, dom){
            dom.className = (dom.className).replace(/err_.*/, '');
          });
        });
        $('img.shifttime_copy').click(function(){
          var dataobject = $(this);

          var sectionId = ('00'+dataobject.attr('name')).slice(-2);

          $('input[name=shigyo_h_'   + sectionId + ']').val( ( $('input[name="workshift_shigyo"]').val() ).split(':')[0] );
          $('input[name=shigyo_m_'   + sectionId + ']').val( ( $('input[name="workshift_shigyo"]').val() ).split(':')[1] );
          $('input[name=syugyo_h_'   + sectionId + ']').val( ( $('input[name="workshift_syugyo"]').val() ).split(':')[0] );
          $('input[name=syugyo_m_'   + sectionId + ']').val( ( $('input[name="workshift_syugyo"]').val() ).split(':')[1] );
          $('input[name=kyukei_1_h_' + sectionId + ']').val( ( $('input[name="workshift_kyukei_1"]').val() ).split(':')[0] );
          $('input[name=kyukei_1_m_' + sectionId + ']').val( ( $('input[name="workshift_kyukei_1"]').val() ).split(':')[1] );
          $('input[name=kyukei_2_h_' + sectionId + ']').val( ( $('input[name="workshift_kyukei_2"]').val() ).split(':')[0] );
          $('input[name=kyukei_2_m_' + sectionId + ']').val( ( $('input[name="workshift_kyukei_2"]').val() ).split(':')[1] );
          $('input[name=workshift_'  + sectionId + ']').val( ( $('input[name="workshift_shigyo"]').val() + $('input[name="workshift_syugyo"]').val() ).replace(/:/g, '') );
          $('input.timer_io').change();

          $({deg:0}).animate({deg:360}, {
            duration: 1000,
            easing: 'swing',

            // 途中経過
            progress:function() {
              dataobject.css({
                transform:'rotate(' + this.deg + 'deg)'
              });
            },

            // アニメーション完了
            complete:function() {}
          });
        });
        $('img.shifttime_input').click(function(){
          var dataobject = $(this);
          console.log( ( dataobject.attr('name') ).slice(-2) );
          $({deg:0}).animate({deg:360}, {
            duration: 1000,
            easing: 'swing',

            // 途中経過
            progress:function() {
              dataobject.css({
                transform:'rotate(' + this.deg + 'deg)'
              });
            },

            // アニメーション完了
            complete:function() {}
          });
        });

      });
    </script>
    <script type="text/javascript">
      $(function(){
        // メニューアイコンサイズ調整
        $('input[name="Menu_icon_size"]').on('input', function(){
          $(this).next().text( (parseInt(this.value)) );
          $('#menu_opener img').css({
            height: parseInt(this.value),
            width: parseInt(this.value),
          });
          localStorage.setItem( (btoa(location.href)).slice(0, 16) + '.ini_Menu_icon_size', parseInt(this.value) );
        });

        // Google recaptcha 可視性調整
        $('input[name="Google_recaptcha_visibility"]').on('input', function(){
          $(this).next().text( (parseFloat(this.value)).toFixed(1) );
          $('.grecaptcha-badge').css('opacity', parseFloat(this.value));
          localStorage.setItem( (btoa(location.href)).slice(0, 16) + '.ini_Google_recaptcha_visibility', parseFloat(this.value) );
        });
      });
    </script>
    <script type="text/javascript">
    $(window).on('load', function(){
      // メニューアイコンサイズ調整
      console.log(localStorage.getItem( (btoa(location.href)).slice(0, 16) + '.ini_Menu_icon_size' ));
      if(null === localStorage.getItem( (btoa(location.href)).slice(0, 16) + '.ini_Menu_icon_size' )){
        // default
        localStorage.setItem( (btoa(location.href)).slice(0, 16) + '.ini_Menu_icon_size', 32);
      }
      $('#menu_opener img').css({
        height: localStorage.getItem( (btoa(location.href)).slice(0, 16) + '.ini_Menu_icon_size' ),
        width: localStorage.getItem( (btoa(location.href)).slice(0, 16) + '.ini_Menu_icon_size' ),
      });

      // Google recaptcha 可視性調整
      console.log(localStorage.getItem( (btoa(location.href)).slice(0, 16) + '.ini_Google_recaptcha_visibility' ));
      if(null === localStorage.getItem( (btoa(location.href)).slice(0, 16) + '.ini_Google_recaptcha_visibility' )){
        // default
        localStorage.setItem( (btoa(location.href)).slice(0, 16) + '.ini_Google_recaptcha_visibility', 1.0);
      }
      $('.grecaptcha-badge').css('opacity', localStorage.getItem( (btoa(location.href)).slice(0, 16) + '.ini_Google_recaptcha_visibility' ) );

    });
    </script>
  </head>
  <body>
    <div class="sidemenu" id="menu_opener">
      <a tabindex="-1"><img alt="" src="./lib/icon/icon_menu.png" /></a>
    </div>
    <div class="sidemenu" id="menu_bar">
      <ul>
        <li><a tabindex="-1" href="#page_reload"><img alt="" src="./lib/icon/icon_reload.png" />更新</a></li>
        <li><a tabindex="-1" href="#data_save"><img alt="" src="./lib/icon/icon_save.png" />保存</a></li>
        <li><a tabindex="-1" href="#conf_setup"><img alt="" src="./lib/icon/icon_setup.png" />設定</a></li>
        <li><a tabindex="-1" href="#conf_reset"><img alt="" src="./lib/icon/icon_setup.png" />リセット</a></li>
        <!-- <li><a tabindex="-1" href="#auth_login"><img alt="" src="./lib/icon/icon_login.png" />ログイン</a></li> -->
        <!-- <li><a tabindex="-1" href="#data_submit"><img alt="" src="./lib/icon/icon_submit.png" />提出</a></li> -->
      </ul>
    </div>
    <div class="sidemenu" id="menu_config_bar">
      <div id="menu_config_bar_close"></div>
      <table>
        <tbody>
          <tr>
            <td></td>
            <td><a tabindex="-1" href="#conf_reset">設定リセット</td>
          </tr>
          <tr>
            <td>Menu icon size</td>
            <td><input type="range" max="70" min="15" step="1" value="1" name="Menu_icon_size" /><output /></td>
          </tr>
          <tr>
            <td>Google recaptcha visibility</td>
            <td><input type="range" max="1" min="0" step="0.1" value="1" name="Google_recaptcha_visibility" /><output /></td>
          </tr>
          <tr>
            <td>Google mail setup</td>
            <td>comming soon</td>
          </tr>
          <tr>
            <td>Account Name</td>
            <td>anonymous</td>
          </tr>
          <tr>
            <td>Mail From</td>
            <td>anonymous</td>
          </tr>
          <tr>
            <td>Mail To</td>
            <td><input type="email" name="Google_mail_sendTo" value="" /></td>
          </tr>
          <tr>
            <td>Mail CC</td>
            <td><input type="email" name="Google_mail_sendCc" value="" /></td>
          </tr>
        </tbody>
      </table>
    </div>
    <div class="sidemenu" id="popUpMesg">
      <div id="popUpMesg_close"></div>
      <div id="popUpMesg_content"></div>
    </div>

    <div id="timetable">
      <h1></h1>
      <h2>&lt; <a class="month_prev">前月</a> <a class="month_this">今月</a> <a class="month_next">翌月</a> &gt;</h2>
      <table id="kintai_timetable">
        <thead>
          <tr>
            <th>日付</th>
            <th>始業</th>
            <th>終業</th>
            <th>休憩(通常)</th>
            <th>休憩(夜間)</th>
            <th>シフト</th>
            <th>備考</th>
          </tr>
          <tr>
            <td>シフト</th>
            <td><input type="time" name="workshift_shigyo" value="09:00"></td>
            <td><input type="time" name="workshift_syugyo" value="18:00"></td>
            <td><input type="time" name="workshift_kyukei_1" value="01:00"></td>
            <td><input type="time" name="workshift_kyukei_2" value="00:00"></td>
            <td></td>
            <td><input type="text" name="" value="09001800"></td>
          </tr>
        </thead>
      </table>
    </div>
  </body>
</html>
